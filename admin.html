<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة المطور - مزاد الزمرد</title>
<link rel="stylesheet" href="style.css">
<style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    h1 { text-align: center; color: #006400; }
    .section { margin-bottom: 40px; }
    .card { background: white; padding: 15px; margin: 10px 0; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    button { padding: 8px 12px; background: red; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: darkred; }
</style>
</head>
<body>

<h1>لوحة المطور</h1>

<div class="section">
    <h2>📌 الخيول المضافة</h2>
    <div id="horsesList"></div>
</div>

<div class="section">
    <h2>👤 المستخدمون المسجلون</h2>
    <div id="usersList"></div>
</div>

<script type="module">
import { app } from './firebase.js';
import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const db = getFirestore(app);
const horsesList = document.getElementById("horsesList");
const usersList = document.getElementById("usersList");

async function loadHorses() {
    const querySnapshot = await getDocs(collection(db, "horses"));
    horsesList.innerHTML = "";
    querySnapshot.forEach((docSnap) => {
        const data = docSnap.data();
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
            <p><strong>اسم الخيل:</strong> ${data.name}</p>
            <p><strong>العمر:</strong> ${data.age}</p>
            <p><strong>الحالة:</strong> ${data.status}</p>
            <button onclick="deleteHorse('${docSnap.id}')">حذف</button>
        `;
        horsesList.appendChild(card);
    });
}

async function loadUsers() {
    const querySnapshot = await getDocs(collection(db, "users"));
    usersList.innerHTML = "";
    querySnapshot.forEach((docSnap) => {
        const data = docSnap.data();
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
            <p><strong>الاسم:</strong> ${data.fullName}</p>
            <p><strong>القبيلة:</strong> ${data.tribe}</p>
            <p><strong>الجوال:</strong> ${data.phone}</p>
        `;
        usersList.appendChild(card);
    });
}

window.deleteHorse = async function(id) {
    if (confirm("⚠ هل أنت متأكد من حذف هذا الخيل؟")) {
        await deleteDoc(doc(db, "horses", id));
        alert("✅ تم الحذف بنجاح");
        loadHorses();
    }
}

loadHorses();
loadUsers();
</script>

</body>
</html> 
